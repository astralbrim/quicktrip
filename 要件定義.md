# ちょいでかけ (QuickTrip) 要件定義書

## 1. プロジェクト概要

### 1.1 基本情報
- **プロダクト名**: ちょいでかけ
- **プロジェクト名**: QuickTrip
- **プロダクトビジョン**: 地元の人が「今からどこ行こうかな」と思った時に、サッと使えるカジュアルなお出かけ先検索サービス
- **開発形態**: Webアプリケーション（スマホファースト）
- **認証**: ユーザーアカウント制（メール/パスワード + ソーシャルログイン）

### 1.2 ターゲットユーザー
- **メインターゲット**: 地元在住者
- **利用シーン**: 
  - 休日の空いた時間に近場で遊びたい
  - 友人や家族と急に出かけることになった
  - 新しい場所を開拓したい

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 時間指定検索
- 現在地から指定時間（片道）で行ける場所を検索
- **プリセット時間**: 10分、30分、1時間、2時間
- **カスタム入力**: 5分〜180分の範囲で自由入力可能（オプション）
- **デフォルト値**: 30分

#### 2.1.2 移動手段選択
- **選択肢**: 徒歩、電車、車、バス
- **デフォルト**: 前回選択した移動手段を記憶
- **初回デフォルト**: 徒歩

#### 2.1.3 スポット表示
- **表示形式**:
  - 地図ビュー（ピン表示）
  - リストビュー
  - ビュー切り替え可能
- **表示情報**:
  - スポット名
  - カテゴリーアイコン
  - 現在地からの時間・距離
  - 営業状況（営業中/まもなく閉店/閉店）
  - 簡単な説明（50文字程度）

#### 2.1.4 カテゴリー
- **優先順位順**:
  1. 観光スポット
  2. レジャースポット
  3. 公園
  4. レストラン
  5. カフェ

### 2.2 フィルター機能（詳細絞り込み）

デフォルトでは非表示、「詳細絞り込み」ボタンで展開

- **営業時間**: 今から行って営業中の場所のみ表示
- **料金帯**:
  - 無料
  - 〜1,000円
  - 〜3,000円
  - 3,000円以上
- **施設条件**:
  - 子連れOK
  - ペット可
  - 駐車場あり
  - バリアフリー

### 2.3 その他機能

#### 2.3.1 検索履歴
- 最近の検索条件を5件まで保存
- **データベースに保存**（ユーザーごと）

#### 2.3.2 位置情報取得
- 起動時に現在地を自動取得
- 取得失敗時は以下の選択肢を表示:
  - 位置情報を有効にする（再取得）
  - 住所を入力する

#### 2.3.3 外部サイト連携
- 各スポットの「詳細を見る」から公式サイトへリンク
- 新規タブで開く

#### 2.3.4 ユーザーアカウント機能
- **認証方法**:
  - メール/パスワード
  - ソーシャルログイン（Google、GitHub）
- **アカウントで管理される情報**:
  - 検索履歴
  - お気に入り（Phase 3）
  - 検索設定の保存

## 3. 非機能要件

### 3.1 パフォーマンス
- 初回表示: 3秒以内
- 検索結果表示: 2秒以内
- スムーズなスクロールとマップ操作

### 3.2 デザイン
- **スマホファースト**のレスポンシブデザイン
- シンプルで直感的なUI
- カジュアルで親しみやすいビジュアル

### 3.3 対応環境
- **デバイス**: スマートフォン優先、タブレット・PC対応
- **ブラウザ**: 
  - Chrome (最新版)
  - Safari (最新版)
  - Firefox (最新版)
  - Edge (最新版)

### 3.4 アクセシビリティ
- 十分なコントラスト比
- タップターゲットは44px以上
- スクリーンリーダー対応（基本レベル）

## 4. 開発フェーズ

### Phase 1 (MVP) - 1週間
- **ユーザー認証機能**（登録、ログイン、ログアウト）
- 基本的な時間・移動手段での検索
- 地図表示（現在地から30分圏内）
- 検索履歴（DBに保存）
- レスポンシブ対応

### Phase 2 - 1週間
- 詳細フィルター機能（営業時間、料金、施設条件）
- リスト表示切り替え
- カテゴリー別表示
- UIの改善
- パフォーマンス最適化

### Phase 3 - 1週間
- お気に入り機能
- ルート案内アプリとの連携
- 住所検索機能
- PWA対応

## 5. 技術スタック候補

### 5.1 フロントエンド
- **Framework**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **認証**: NextAuth.js

### 5.2 バックエンド
- **Framework**: Hono
- **ランタイム**: Cloudflare Workers
- **データベース**: Cloudflare D1
- **ORM**: Prisma

### 5.3 地図・位置情報
- **地図表示**: Leaflet + OpenStreetMap
- **ルート検索**: OpenRouteService API（月2,000リクエストまで無料）
- **ジオコーディング**: Nominatim API（無料）

### 5.4 場所データ
- **メイン**: Overpass API（OpenStreetMap、無料）
- **サブ**: Foursquare Places API（月10万リクエストまで無料）

### 5.5 インフラ
- **フロントエンドホスティング**: Vercel
- **バックエンドホスティング**: Cloudflare Workers
- **モノレポ管理**: Turborepo
- **パッケージマネージャー**: pnpm

## 6. 制約事項
- 初期は完全無料で運用可能な技術スタックを選定
- スケール時に有料プランへの移行を検討
- **個人情報の取り扱い**: メールアドレスとパスワードのみ収集、適切に暗号化して保存

## 7. 成功指標
- 月間アクティブユーザー数
- 平均セッション時間
- リピート率
- 検索から詳細ページへの遷移率
- ユーザー登録率

## 8. セキュリティ要件
- パスワードの暗号化（bcrypt等）
- HTTPS通信の強制
- JWTトークンによる認証
- XSS、CSRF対策
- 適切なCORS設定